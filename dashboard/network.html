<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>Sentinel · Network Report</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="stylesheet" href="./vendor/reset.min.css" />
    <link rel="stylesheet" href="./css/styles.css" />
  </head>

  <body class="sentinel-body">
    <!-- 상단 네비게이션 바 -->
    <header class="top-nav">
      <div class="top-nav-left">
        <div class="top-logo">
          <span class="top-logo-main">SENTINEL</span>
          <span class="top-logo-sub">DASHBOARD</span>
        </div>

        <nav class="top-menu">
          <a class="top-menu-item" href="./dashboard.html">DASHBOARD</a>
          <a class="top-menu-item" href="./report.html">REPORT</a>
          <a class="top-menu-item" href="./logs.html">LOGS</a>
          <a class="top-menu-item" href="./reason.html">REASON</a>
          <a
            class="top-menu-item top-menu-item--active"
            href="./network.html"
            >NETWORK</a
          >
          <a class="top-menu-item" href="./settings.html">SETTINGS</a>
        </nav>
      </div>

      <div class="top-nav-right">
        <span class="top-updated-label">UPDATED:</span>
        <span id="top-updated-at" class="top-updated-value">--:--:-- KST</span>

        <button id="btn-refresh" class="btn btn-small">Refresh</button>
      </div>
    </header>

    <!-- 상단 안내 바 -->
    <section class="banner-info">
      If you want to view the latest logs, click the refresh button.
    </section>

    <!-- 메인 레이아웃 -->
    <main class="report-layout">
      <section class="report-main">
        <!-- 좌측 사이드 메뉴 (리포트 스타일 공통 사용) -->
        <aside class="report-sidebar">
          <div class="report-sidebar-inner">
            <div class="side-group">
              <div class="side-group-title">| NETWORK</div>
              <div class="side-link side-link--active">
                외부 IP 사용 현황
              </div>
              <div class="side-link">
                공인 IP 대역 / 사설망 분석
              </div>
              <div class="side-link">
                외부 IP 사용 의심 PC 로그
              </div>
            </div>
          </div>
        </aside>

        <!-- 우측 본문 카드들 -->
        <section class="report-main-content">
          <!-- 1행: PUBLIC 대역 개수 + 대역폭 별 연결 사설망 -->
          <div class="report-row report-row--top">
            <!-- PUBLIC 대역 개수 + 파이차트 -->
            <article class="card report-card report-card--half">
              <header class="card-header">
                <h3 class="card-title">PUBLIC 대역 개수</h3>
                <span class="card-subtitle">
                  공인 IP가 탐지된 /16 대역 수 및 사용 현황
                </span>
              </header>
              <div class="card-body network-top-body">
                <div class="pill-large">
                  <div id="public-band-count" class="pill-large-main">--</div>
                  <div class="pill-large-label">PUBLIC 대역 개수</div>
                </div>

                <div class="network-chart-area">
                  <h4 class="card-subtitle">대역폭 사용 현황</h4>
                  <canvas id="chart-public-bands" height="200"></canvas>
                  <p
                    id="public-bands-empty"
                    class="empty-hint"
                    style="display: none"
                  >
                    공인 IP 대역 사용 로그가 없습니다.
                  </p>
                </div>
              </div>
            </article>

            <!-- 대역폭 별 연결 사설망 (상위 3개) -->
            <article class="card report-card report-card--half">
              <header class="card-header">
                <h3 class="card-title">
                  대역폭 별 연결 사설망 (대역폭 사용 개수 상위 3개)
                </h3>
                <span class="card-subtitle">
                  공인 IP /16 대역 기준으로 연결된 사설망과 중요정보 탐지 로그
                </span>
              </header>
              <div class="card-body">
                <div id="top-private-bands" class="network-bands-cards">
                  <p class="empty-hint">
                    데이터를 불러오는 중입니다...
                  </p>
                </div>
              </div>
            </article>
          </div>

          <!-- 2행: 외부 IP 사용 의심 PC 정보 + 로그 테이블 -->
          <div class="report-row">
            <!-- 외부 IP 사용 의심 PC 정보 -->
            <article class="card report-card report-card--half">
              <header class="card-header">
                <h3 class="card-title">외부 IP 사용 의심 PC 정보</h3>
                <span class="card-subtitle">
                  PUBLIC IP / PRIVATE IP / PC NAME 조합으로 직접 노출 및 신규
                  출구 탐지
                </span>
              </header>
              <div class="card-body">
                <ul id="suspicious-pc-list" class="bullet-list">
                  <li>데이터를 불러오는 중입니다...</li>
                </ul>
                <p class="empty-hint">
                  • <strong>(PUBLIC IP) / (PRIVATE IP) / (PC NAME)</strong> 형식으로
                  표시됩니다.<br />
                  • 직접 노출: PUBLIC IP와 PRIVATE IP가 동일한 경우<br />
                  • 신규 출구: PRIVATE IP가 사설망이 아닌 경우
                </p>
              </div>
            </article>

            <!-- 외부 IP 사용 의심 PC 로그 테이블 -->
            <article class="card report-card report-card--half">
              <header class="card-header">
                <h3 class="card-title">외부 IP 사용 의심 PC 로그</h3>
                <span class="card-subtitle">
                  의심 PC에서 발생한 LLM/MCP 요청 이력 (최신 50건)
                </span>
              </header>
              <div class="card-body">
                <div class="table-wrapper">
                  <table class="table network-table">
                    <thead>
                      <tr>
                        <th>Prompt</th>
                        <th>Time</th>
                        <th>Host</th>
                        <th>PC Name</th>
                        <th>Public IP</th>
                        <th>Private IP</th>
                        <th>Interface</th>
                        <th>Action</th>
                        <th>Sensitivity</th>
                        <th>Block files</th>
                        <th>Entity</th>
                      </tr>
                    </thead>
                    <tbody id="network-table-body">
                      <tr>
                        <td colspan="11">데이터를 불러오는 중입니다...</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </article>
          </div>
        </section>
      </section>
    </main>

    <!-- 스크립트 -->
    <script src="./vendor/chart.umd.min.js"></script>
    <script src="./js/api.js"></script>
    <script src="./js/network.js"></script>
  </body>
</html>
