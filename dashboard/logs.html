<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>Sentinel Logs</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="stylesheet" href="./vendor/reset.min.css" />
    <link rel="stylesheet" href="./css/styles.css" />

    <!-- ✅ logs 페이지에서만: 토글 가시성/정렬 개선 (간단) -->
    <style>
      .logs-header-right{
        display:flex;
        align-items:center;
        gap:10px;
        flex-wrap:wrap;
      }
      .logs-toggle{
        display:flex;
        align-items:center;
        gap:8px;
        padding:6px 10px;
        border:1px solid rgba(15,23,42,.12);
        border-radius:10px;
        background:#f8fafc;
        user-select:none;
        white-space:nowrap;
      }
      .logs-toggle input{
        width:16px;
        height:16px;
        accent-color:#2563eb;
      }
      .logs-toggle:hover{
        background:#eef2ff;
        border-color:rgba(37,99,235,.35);
      }
    </style>
  </head>

  <body class="sentinel-body">
    <!-- 상단 네비게이션 바 -->
    <header class="top-nav">
      <div class="top-nav-left">
        <div class="top-logo">
          <span class="top-logo-main">SENTINEL</span>
          <span class="top-logo-sub">DASHBOARD</span>
        </div>

        <nav class="top-menu">
          <a class="top-menu-item" href="./dashboard.html">Dashboard</a>
          <a class="top-menu-item" href="./report.html">Report</a>
          <a class="top-menu-item top-menu-item--active" href="./logs.html">Logs</a>
          <a class="top-menu-item" href="./reason.html">Analysis</a>
          <a class="top-menu-item" href="./network.html">Network</a>
          <a class="top-menu-item" href="./score.html">Score</a>
          <a class="top-menu-item" href="./settings.html">Settings</a>
        </nav>
      </div>

      <div class="top-nav-right">
        <span class="top-updated-label">UPDATED:</span>
        <span id="top-updated-at" class="top-updated-value">--:--:-- KST</span>

        <button id="btn-refresh" class="btn btn-small">Refresh</button>
        <button id="btn-logout" class="btn btn-small btn-ghost">Logout</button>
      </div>
    </header>

    <!-- 메인 컨텐츠: 전체 로그 페이지 -->
    <main class="dashboard-layout logs-layout">
      <section class="card card-table logs-card">
        <div class="card-header logs-header">
          <div class="logs-header-left">
            <h3 class="card-title">전체 탐지 로그</h3>
            <span class="card-subtitle">에이전트에서 수집된 모든 요청에 대한 중요정보 탐지 로그를 조회합니다.</span>
          </div>

          <!-- 상단 검색 & 필터 -->
          <div class="logs-header-right">
            <div class="logs-search">
              <input
                id="logs-search-input"
                class="logs-search-input"
                type="text"
                placeholder="Search for prompt, host, IP..."
              />
            </div>

            <div class="logs-category">
              <select id="logs-category-select" class="logs-category-select">
                <option value="">All Categories</option>
                <option value="prompt">Prompt</option>
                <option value="host">Host</option>
                <option value="pc_name">PC Name</option>
                <option value="public_ip">Public IP</option>
                <option value="private_ip">Private IP</option>
                <option value="entity">Entity</option>
              </select>
            </div>

            <!-- ✅ Search 오른쪽에 배치 -->
            <button id="logs-search-btn" class="btn btn-small">Search</button>

            <!-- ✅ 전체 로그 보기 토글 (기본 OFF: 현재 코드에서 sensitive_only=true 유지라면 JS에서 checked 기준으로 처리) -->
            <label class="logs-toggle" title="체크하면 전체 로그를 조회합니다. (해제 시 탐지 로그만 조회)">
              <input type="checkbox" id="logs-sensitive-only" />
              <span>전체 로그 보기</span>
            </label>
          </div>
        </div>

        <!-- 로그 테이블 -->
        <div class="table-wrapper logs-table-wrapper">
          <table class="log-table">
            <thead>
              <tr>
                <th class="col-checkbox">
                  <input type="checkbox" id="logs-check-all" />
                </th>
                <th>프롬프트 입력 내용</th>
                <th>탐지 시간</th>
                <th>서비스명</th>
                <th>PC 이름</th>
                <th>공인 IP</th>
                <th>사설 IP</th>
                <th>인터페이스</th>
                <th>처리 결과</th>
                <th>민감 여부</th>
                <th>차단 여부</th>
                <th>탐지 정보 내역</th>
              </tr>
            </thead>
            <tbody id="logs-table-body">
              <!-- JS에서 채움 -->
            </tbody>
          </table>
        </div>

        <!-- 하단: 페이지네이션 & CSV 버튼 -->
        <div class="logs-footer">
          <div class="logs-footer-left">
            <button id="logs-export-csv" class="btn btn-small btn-ghost">
              선택 항목 CSV 내보내기
            </button>
          </div>

          <div class="logs-footer-right">
            <button id="logs-page-prev" class="pager-btn" disabled>&lt; Previous</button>
            <span class="pager-info">
              Page <span id="logs-page-current">1</span>
              / <span id="logs-page-total">1</span>
            </span>
            <button id="logs-page-next" class="pager-btn" disabled>Next &gt;</button>
          </div>
        </div>
      </section>
    </main>

    <!-- 스크립트 -->
    <script src="./vendor/chart.umd.min.js"></script>
    <script src="./js/api.js"></script>
    <script src="./js/logs.js"></script>
  </body>
</html>
